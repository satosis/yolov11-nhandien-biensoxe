title: Shed Dashboard
views:
  - title: Overview
    path: overview
    cards:
      - type: entities
        title: Cảnh báo camera
        show_header_toggle: false
        entities:
          - entity: binary_sensor.shed_camera_shift_motion
            name: Camera bị quay lệch
          - entity: sensor.shed_camera_shift_status
            name: Trạng thái camera
          - entity: sensor.shed_camera_shift_last_event
            name: Lần cảnh báo gần nhất

      - type: entities
        title: Số lượng qua vạch đỏ (text)
        show_header_toggle: false
        entities:
          - entity: sensor.shed_people_count
            name: Người qua vạch đỏ
          - entity: sensor.shed_vehicle_count
            name: Xe qua vạch đỏ

      - type: markdown
        title: Quy tắc tự động
        content: |
          - Nếu không có người 5 phút, camera tự về vị trí mặc định (góc giữa/cổng).
          - Nhãn vùng nhận diện: **Người = vàng**, **Xe = xanh**.
          - Nút nhận diện nâng cao làm trên Telegram, không thao tác trên HA.

      - type: entities
        title: OCR tự bật lại sau khi quay tay
        show_header_toggle: false
        entities:
          - entity: sensor.shed_ptz_mode
            name: Chế độ PTZ
          - entity: switch.shed_ocr_enabled
            name: OCR Enabled (bật/tắt)
          - type: attribute
            entity: switch.shed_ocr_enabled
            attribute: countdown_minutes
            name: Đếm ngược bật OCR (phút)

      - type: grid
        title: Điều khiển hướng quay camera
        square: false
        columns: 3
        cards:
          - type: button
            name: Lên
            icon: mdi:arrow-up-bold
            show_state: false
            tap_action:
              action: call-service
              service: mqtt.publish
              data:
                topic: shed/cmd/ptz_operation
                payload: '{"operation":"0","duration":200}'
          - type: button
            name: Toàn cảnh
            icon: mdi:panorama
            show_state: false
            tap_action:
              action: call-service
              service: mqtt.publish
              data:
                topic: shed/cmd/ptz_panorama
                payload: "1"
          - type: button
            name: Dừng
            icon: mdi:stop
            show_state: false
            tap_action:
              action: call-service
              service: mqtt.publish
              data:
                topic: shed/cmd/ptz_operation
                payload: '{"operation":"8","duration":100}'
          - type: button
            name: Trái
            icon: mdi:arrow-left-bold
            show_state: false
            tap_action:
              action: call-service
              service: mqtt.publish
              data:
                topic: shed/cmd/ptz_operation
                payload: '{"operation":"2","duration":200}'
          - type: button
            name: Về vị trí mặc định
            icon: mdi:crosshairs-gps
            show_state: false
            tap_action:
              action: call-service
              service: mqtt.publish
              data:
                topic: shed/cmd/ptz_gate
                payload: "1"
          - type: button
            name: Phải
            icon: mdi:arrow-right-bold
            show_state: false
            tap_action:
              action: call-service
              service: mqtt.publish
              data:
                topic: shed/cmd/ptz_operation
                payload: '{"operation":"3","duration":200}'
          - type: button
            name: Xuống
            icon: mdi:arrow-down-bold
            show_state: false
            tap_action:
              action: call-service
              service: mqtt.publish
              data:
                topic: shed/cmd/ptz_operation
                payload: '{"operation":"1","duration":200}'


      - type: horizontal-stack
        cards:
          - type: button
            name: Xem Frigate NVR
            icon: mdi:cctv
            tap_action:
              action: url
              url_path: http://127.0.0.1:5000
          - type: button
            name: Xem Frigate Events
            icon: mdi:history
            tap_action:
              action: url
              url_path: http://127.0.0.1:5000/review

      - type: picture-entity
        title: "Camera HA trực tiếp (AI Overlay: vạch đỏ + khoanh vùng)"
        entity: camera.shed_ai_overlay
        camera_view: live

      - type: picture-entity
        title: Camera Frigate gốc (không overlay)
        entity: camera.frigate_cam1
        camera_view: live
